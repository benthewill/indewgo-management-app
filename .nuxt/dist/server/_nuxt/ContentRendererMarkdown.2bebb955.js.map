{"version":3,"file":"ContentRendererMarkdown.2bebb955.js","sources":["../../../../node_modules/@nuxt/content/dist/runtime/components/ContentRendererMarkdown.vue"],"sourcesContent":["<script>\nimport { h, resolveComponent, Text, defineComponent } from \"vue\";\nimport destr from \"destr\";\nimport { pascalCase } from \"scule\";\nimport { find, html } from \"property-information\";\nimport htmlTags from \"html-tags\";\nimport { useRuntimeConfig, useRoute } from \"#app\";\nconst DEFAULT_SLOT = \"default\";\nconst rxOn = /^@|^v-on:/;\nconst rxBind = /^:|^v-bind:/;\nconst rxModel = /^v-model/;\nconst nativeInputs = [\"select\", \"textarea\", \"input\"];\nexport default defineComponent({\n  name: \"ContentRendererMarkdown\",\n  props: {\n    value: {\n      type: Object,\n      required: true\n    },\n    excerpt: {\n      type: Boolean,\n      default: false\n    },\n    tag: {\n      type: String,\n      default: \"div\"\n    },\n    components: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  async setup(props) {\n    const { content: { tags = {} } } = useRuntimeConfig().public;\n    await resolveContentComponents(props.value.body, {\n      tags: {\n        ...tags,\n        ...props.value?._components || {},\n        ...props.components\n      }\n    });\n    return { tags };\n  },\n  render(ctx) {\n    const { tags, tag, value, components } = ctx;\n    if (!value) {\n      return null;\n    }\n    let body = value.body || value;\n    if (ctx.excerpt && value.excerpt) {\n      body = value.excerpt;\n    }\n    const meta = {\n      ...value,\n      tags: {\n        ...tags,\n        ...value?._components || {},\n        ...components\n      }\n    };\n    let component = meta.component || tag;\n    if (typeof meta.component === \"object\") {\n      component = meta.component.name;\n    }\n    component = resolveVueComponent(component);\n    const children = (body.children || []).map((child) => renderNode(child, h, meta));\n    return h(\n      component,\n      {\n        ...meta.component?.props,\n        ...this.$attrs\n      },\n      {\n        default: createSlotFunction(children)\n      }\n    );\n  }\n});\nfunction renderNode(node, h2, documentMeta, parentScope = {}) {\n  if (node.type === \"text\") {\n    return h2(Text, node.value);\n  }\n  const originalTag = node.tag;\n  const renderTag = typeof node.props?.__ignoreMap === \"undefined\" && documentMeta.tags[originalTag] || originalTag;\n  if (node.tag === \"binding\") {\n    return renderBinding(node, h2, documentMeta, parentScope);\n  }\n  const component = resolveVueComponent(renderTag);\n  if (typeof component === \"object\") {\n    component.tag = originalTag;\n  }\n  const props = propsToData(node, documentMeta);\n  return h2(\n    component,\n    props,\n    renderSlots(node, h2, documentMeta, { ...parentScope, ...props })\n  );\n}\nfunction renderBinding(node, h2, documentMeta, parentScope = {}) {\n  const data = {\n    ...parentScope,\n    $route: () => useRoute(),\n    $document: documentMeta,\n    $doc: documentMeta\n  };\n  const splitter = /\\.|\\[(\\d+)\\]/;\n  const keys = node.props?.value.trim().split(splitter).filter(Boolean);\n  const value = keys.reduce((data2, key) => {\n    if (key in data2) {\n      if (typeof data2[key] === \"function\") {\n        return data2[key]();\n      } else {\n        return data2[key];\n      }\n    }\n    return {};\n  }, data);\n  return h2(Text, value);\n}\nfunction renderSlots(node, h2, documentMeta, parentProps) {\n  const children = node.children || [];\n  const slots = children.reduce((data, node2) => {\n    if (!isTemplate(node2)) {\n      data[DEFAULT_SLOT].push(renderNode(node2, h2, documentMeta, parentProps));\n      return data;\n    }\n    if (isDefaultTemplate(node2)) {\n      data[DEFAULT_SLOT].push(...(node2.children || []).map((child) => renderNode(child, h2, documentMeta, parentProps)));\n      return data;\n    }\n    const slotName = getSlotName(node2);\n    data[slotName] = (node2.children || []).map((child) => renderNode(child, h2, documentMeta, parentProps));\n    return data;\n  }, {\n    [DEFAULT_SLOT]: []\n  });\n  const slotEntries = Object.entries(slots).map(([name, vDom]) => [name, createSlotFunction(vDom)]);\n  return Object.fromEntries(slotEntries);\n}\nfunction propsToData(node, documentMeta) {\n  const { tag = \"\", props = {} } = node;\n  return Object.keys(props).reduce(function(data, key) {\n    if (key === \"__ignoreMap\") {\n      return data;\n    }\n    const value = props[key];\n    if (rxModel.test(key) && !nativeInputs.includes(tag)) {\n      return propsToDataRxModel(key, value, data, documentMeta);\n    }\n    if (key === \"v-bind\") {\n      return propsToDataVBind(key, value, data, documentMeta);\n    }\n    if (rxOn.test(key)) {\n      return propsToDataRxOn(key, value, data, documentMeta);\n    }\n    if (rxBind.test(key)) {\n      return propsToDataRxBind(key, value, data, documentMeta);\n    }\n    const { attribute } = find(html, key);\n    if (Array.isArray(value) && value.every((v) => typeof v === \"string\")) {\n      data[attribute] = value.join(\" \");\n      return data;\n    }\n    data[attribute] = value;\n    return data;\n  }, {});\n}\nfunction propsToDataRxModel(key, value, data, documentMeta) {\n  const number = (d) => +d;\n  const trim = (d) => d.trim();\n  const noop = (d) => d;\n  const mods = key.replace(rxModel, \"\").split(\".\").filter((d) => d).reduce((d, k) => {\n    d[k] = true;\n    return d;\n  }, {});\n  const field = \"value\";\n  const event = mods.lazy ? \"change\" : \"input\";\n  const processor = mods.number ? number : mods.trim ? trim : noop;\n  data[field] = evalInContext(value, documentMeta);\n  data.on = data.on || {};\n  data.on[event] = (e) => documentMeta[value] = processor(e);\n  return data;\n}\nfunction propsToDataVBind(_key, value, data, documentMeta) {\n  const val = evalInContext(value, documentMeta);\n  data = Object.assign(data, val);\n  return data;\n}\nfunction propsToDataRxOn(key, value, data, documentMeta) {\n  key = key.replace(rxOn, \"\");\n  data.on = data.on || {};\n  data.on[key] = () => evalInContext(value, documentMeta);\n  return data;\n}\nfunction propsToDataRxBind(key, value, data, documentMeta) {\n  key = key.replace(rxBind, \"\");\n  data[key] = evalInContext(value, documentMeta);\n  return data;\n}\nconst resolveVueComponent = (component) => {\n  if (!htmlTags.includes(component)) {\n    const componentFn = resolveComponent(pascalCase(component), false);\n    if (typeof componentFn === \"object\") {\n      return componentFn;\n    }\n  }\n  return component;\n};\nfunction evalInContext(code, context) {\n  const result = code.split(\".\").reduce((o, k) => typeof o === \"object\" ? o[k] : void 0, context);\n  return typeof result === \"undefined\" ? destr(code) : result;\n}\nfunction getSlotName(node) {\n  let name = \"\";\n  for (const propName of Object.keys(node.props || {})) {\n    if (!propName.startsWith(\"#\") && !propName.startsWith(\"v-slot:\")) {\n      continue;\n    }\n    name = propName.split(/[:#]/, 2)[1];\n    break;\n  }\n  return name || DEFAULT_SLOT;\n}\nfunction createSlotFunction(nodes) {\n  return nodes.length ? () => mergeTextNodes(nodes) : void 0;\n}\nfunction isDefaultTemplate(node) {\n  return isTemplate(node) && getSlotName(node) === DEFAULT_SLOT;\n}\nfunction isTemplate(node) {\n  return node.tag === \"template\";\n}\nfunction mergeTextNodes(nodes) {\n  const mergedNodes = [];\n  for (const node of nodes) {\n    const previousNode = mergedNodes[mergedNodes.length - 1];\n    if (node.type === Text && previousNode?.type === Text) {\n      previousNode.children = previousNode.children + node.children;\n    } else {\n      mergedNodes.push(node);\n    }\n  }\n  return mergedNodes;\n}\nasync function resolveContentComponents(body, meta) {\n  const components = Array.from(new Set(loadComponents(body, meta)));\n  await Promise.all(components.map(async (c) => {\n    const resolvedComponent = resolveComponent(c);\n    if (resolvedComponent?.__asyncLoader && !resolvedComponent.__asyncResolved) {\n      await resolvedComponent.__asyncLoader();\n    }\n  }));\n  function loadComponents(node, documentMeta) {\n    if (node.type === \"text\" || node.tag === \"binding\") {\n      return [];\n    }\n    const renderTag = typeof node.props?.__ignoreMap === \"undefined\" && documentMeta.tags[node.tag] || node.tag;\n    const components2 = [];\n    if (node.type !== \"root\" && !htmlTags.includes(renderTag)) {\n      components2.push(renderTag);\n    }\n    for (const child of node.children || []) {\n      components2.push(...loadComponents(child, documentMeta));\n    }\n    return components2;\n  }\n}\n</script>\n"],"names":[],"mappings":"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"}